<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>DevOps</title>
    <link rel="icon" type="image/svg+xml" href='https://www.loora.ai/favicon.png' />
  </head>
  <style>
    * {
      font-family: Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      min-height: 100dvh;
      height: 100%;
      background: #fff;
      padding: 20px;
    }

    .title-box {
      text-align: center;
      font-size: 2rem;
      font-weight: bold;
      padding: 20px;
      background: linear-gradient(
        to bottom right,
        hsla(210, 100%, 96%, 0.3) 25%,
        hsla(215, 15%, 97%, 0.2) 100%
      );
      border: 1px solid hsl(215, 15%, 92%);
      border-radius: 12px;

      color: hsl(215, 15%, 12%);
      max-width: 1050px;
      margin: 40px auto 20px auto;
    }

    .content {
      max-width: 1050px;
      margin: 0 auto 80px auto;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      grid-template-rows: 1fr;
      align-items: stretch;
    }

    .card {
      position: relative;
      text-decoration: none;
      flex-basis: 140px;
      flex-shrink: 0;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow:
        rgb(255, 255, 255) 0 2px 0px inset,
        rgba(232, 234, 238, 0.3) 0px -2px 0px inset,
        rgba(223, 226, 231, 0.5) 0px 1px 2px 0px;

      color: hsl(215, 15%, 12%);
      display: block;
      border-radius: 12px;
      border: 1px solid hsl(215, 15%, 92%);
      transform: scale(100%);
      transition:
        border 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
        box-shadow 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
        transform 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
      padding: 28px;
      background: linear-gradient(
        to bottom right,
        hsla(210, 100%, 96%, 0.3) 25%,
        hsla(215, 15%, 97%, 0.2) 100%
      );
    }

    .card:hover {
      text-decoration: underline;
      border-color: hsl(210, 100%, 80%);
      box-shadow: 0px 2px 8px hsl(210, 100%, 90%);
    }

    .image-wrapper {
      width: 80px;
      height: 80px;
      overflow: hidden;
      margin: 0 auto;
    }

    img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .title {
      text-align: center;
      color: hsl(215, 15%, 12%);
      font-weight: bold;
      margin-top: 20px;
      font-size: 1rem;
      line-height: 1.5;
    }
    .status {
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-left: 5px; /* Space between title and dot */
    }

    .status.up {
      background-color: green; /* Green dot for up status */
    }

    .status.down {
      background-color: red; /* Red dot for down status */
    }

    .status.unknown {
      background-color: orange;
    }

    .card:hover {
      transform: scale(110%);
    }
  </style>

  <script>
    const cardConfig = [
      {
        title: "JumpCloud AdminPortal",
        image:
          "https://jumpcloud.com/wp-content/uploads/2023/03/jumpcloud.png",
        link: "https://console.jumpcloud.com/#/",
      },
      {
        title: "JumpCloud UserPortal",
        image:
          "https://i0.wp.com/securityaffairs.com/wp-content/uploads/2023/07/image-27.png?ssl=1",
        link: "https://console.jumpcloud.com/userconsole#/",
      },
    ];
    const cardConfig2 = [
      {
        title: "Jaeger",
        image:
          "https://www.jaegertracing.io/img/jaeger-icon-reverse-color.svg",
        link: "https://jaeger.data.internal.loora.tech"
      },
      {
        title: "Prometheus",
        image:
          "https://www.gravatar.com/avatar/63f4dc6944f814f3b2440a3c41dd400b?s=120&r=g&d=404",
        link: "https://prometheus.data.internal.loora.tech"
      },
      {
        title: "Thanos",
        image:
          "https://i1.daumcdn.net/thumb/C300x300/?fname=https://blog.kakaocdn.net/dn/bTRdIg/btslufCL7gc/38sihyfShQTmELvFOmc5DK/img.png",
        link: "https://thanos.data.internal.loora.tech"
      },
      {
        title: "AlertManager",
        image:
          "https://play-lh.googleusercontent.com/HhuDvidUsvztQYHv2Ah9PU6xTilfcJvlVqYGGJuxK0U0Tygwns5ZdCRhLxE-Bwf4KQ",
        link: "https://alertmanager.data.internal.loora.tech"
      },
      {
        title: "Grafana Data",
        image:
          "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Grafana_icon.svg/1969px-Grafana_icon.svg.png",
        link: "https://grafana.data.internal.loora.tech",
      },
      {
        title: "ArgoCD Data",
        image:
          "https://icon.icepanel.io/Technology/svg/Argo-CD.svg",
        link: "https://argocd.data.internal.loora.tech",
      },
      {
        title: "AirFlow Data",
        image:
          "https://upload.wikimedia.org/wikipedia/commons/thumb/d/de/AirflowLogo.png/1200px-AirflowLogo.png",
        link: "https://airflow.data.internal.loora.tech",
      },
    ];
    const cardConfig3 = [
      {
        title: "Jaeger",
        image:
          "https://www.jaegertracing.io/img/jaeger-icon-reverse-color.svg",
        link: "https://jaeger.dev.internal.loora.tech"
      },
      {
        title: "Prometheus",
        image:
          "https://www.gravatar.com/avatar/63f4dc6944f814f3b2440a3c41dd400b?s=120&r=g&d=404",
        link: "https://prometheus.dev.internal.loora.tech"
      },
      {
        title: "Thanos",
        image:
          "https://i1.daumcdn.net/thumb/C300x300/?fname=https://blog.kakaocdn.net/dn/bTRdIg/btslufCL7gc/38sihyfShQTmELvFOmc5DK/img.png",
        link: "https://thanos.dev.internal.loora.tech"
      },
      {
        title: "AlertManager",
        image:
          "https://play-lh.googleusercontent.com/HhuDvidUsvztQYHv2Ah9PU6xTilfcJvlVqYGGJuxK0U0Tygwns5ZdCRhLxE-Bwf4KQ",
        link: "https://alertmanager.dev.internal.loora.tech"
      },
      {
        title: "Grafana Dev",
        image:
          "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Grafana_icon.svg/1969px-Grafana_icon.svg.png",
        link: "https://grafana.dev.internal.loora.tech",
      },
      {
        title: "ArgoCD Dev",
        image:
          "https://icon.icepanel.io/Technology/svg/Argo-CD.svg",
        link: "https://argocd.dev.internal.loora.tech",
      },
    ];
    const cardConfig4 = [
      {
        title: "Jaeger",
        image:
          "https://www.jaegertracing.io/img/jaeger-icon-reverse-color.svg",
        link: "https://jaeger.staging.internal.loora.tech"
      },
      {
        title: "Prometheus",
        image:
          "https://www.gravatar.com/avatar/63f4dc6944f814f3b2440a3c41dd400b?s=120&r=g&d=404",
        link: "https://prometheus.staging.internal.loora.tech"
      },
      {
        title: "Thanos",
        image:
          "https://i1.daumcdn.net/thumb/C300x300/?fname=https://blog.kakaocdn.net/dn/bTRdIg/btslufCL7gc/38sihyfShQTmELvFOmc5DK/img.png",
        link: "https://thanos.staging.internal.loora.tech"
      },
      {
        title: "AlertManager",
        image:
          "https://play-lh.googleusercontent.com/HhuDvidUsvztQYHv2Ah9PU6xTilfcJvlVqYGGJuxK0U0Tygwns5ZdCRhLxE-Bwf4KQ",
        link: "https://alertmanager.staging.internal.loora.tech"
      },
      {
        title: "Grafana Staging",
        image:
          "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Grafana_icon.svg/1969px-Grafana_icon.svg.png",
        link: "https://grafana.staging.internal.loora.tech",
      },
      {
        title: "ArgoCD Staging",
        image:
          "https://icon.icepanel.io/Technology/svg/Argo-CD.svg",
        link: "https://argocd.staging.internal.loora.tech",
      },
    ];

    const cardConfig5 = [
      {
        title: "IAC",
        image:
          "https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg",
        link: "https://github.com/Loora-ai/loora-iac/actions"
      },
      {
        title: "K8S deployments",
        image:
          "https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg",
        link: "https://github.com/Loora-ai/loora-k8s-deployments/actions"
      },
    ];

    function createCard(config) {
      const card = document.createElement("a");
      card.classList.add("card");
      card.href = config.link;
      card.target = "_blank";
      const imageWrapper = document.createElement("div");
      imageWrapper.classList.add("image-wrapper");
      const image = document.createElement("img");
      image.src = config.image;
      image.alt = config.title;
      const title = document.createElement("div");
      title.classList.add("title");
      title.textContent = config.title;

      const statusDot = document.createElement("div");
      statusDot.classList.add("status", "unknown"); // Set default as 'unknown'
      statusDot.classList.add(config.status === 'Up' ? 'up' : 'down'); // Placeholder, initially assume down
      title.appendChild(statusDot);
      imageWrapper.appendChild(image);
      card.appendChild(imageWrapper);
      card.appendChild(title);
      
      return card;
    }

    async function checkServiceStatus(card) {
      try {
        const response = await fetch(card.link, { mode: "no-cors" });
        const cardElement = document.querySelector(`a[href='${card.link}']`);
        const statusDot = cardElement.querySelector(".status");

        if (response.type === "opaque" || response.ok) {
          card.status = "Up"; 
          statusDot.className = "status up"; 
        } else {
          card.status = "Down"; 
          statusDot.className = "status down";
        }
      } catch (error) {
        const cardElement = document.querySelector(`a[href='${card.link}']`);
        const statusDot = cardElement.querySelector(".status");
        card.status = "Down"; 
        statusDot.className = "status down"; 
      }
    }

    function startStatusCheck(cards) {
      cards.forEach((card) => checkServiceStatus(card)); // Initial immediate check
      setInterval(() => {
        cards.forEach((card) => checkServiceStatus(card));
      }, 15000); 
    }
    function renderAllCards(id, config) {
      const content = document.querySelector(id);
      config.forEach((config) => {
        const card = createCard(config);
        content.appendChild(card);
      });
    }

  </script>

  <body>
    <div class="title-box">DevOps Portal</div>
    <div id="content-1" class="content"></div>
    <div class="title-box">Data Environment</div>
    <div id="content-2" class="content"></div>
    <div class="title-box">Dev Environment</div>
    <div id="content-3" class="content"></div>
    <div class="title-box">Staging Environment</div>
    <div id="content-4" class="content"></div>
    <div class="title-box">Github Actions</div>
    <div id="content-5" class="content"></div>
  </body>
  <script>
    renderAllCards("#content-1", cardConfig);
    renderAllCards("#content-2", cardConfig2);
    renderAllCards("#content-3", cardConfig3);
    renderAllCards("#content-4", cardConfig4);
    renderAllCards("#content-5", cardConfig5);
    startStatusCheck(cardConfig);
    startStatusCheck(cardConfig2);
    startStatusCheck(cardConfig3);
    startStatusCheck(cardConfig4);
    </script>
</html>
